---
import Layout from "../layouts/Layout.astro";
---

<Layout>
  <h1>Sub√≠ una imagen a Cloudinary</h1>
  <form id="upload-form" enctype="multipart/form-data">
    <input type="file" name="file" required />
    <button type="submit">Subir</button>
  </form>

  <div id="result"></div>

  <script>
    const form = document.getElementById("upload-form");
    const result = document.getElementById("result");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const formData = new FormData(form);

      const res = await fetch("/api/upload", {
        method: "POST",
        body: formData,
      });

      const data = await res.json();

      if (data.success) {
        result.innerHTML = `<p>Subida exitosa:</p><img src="${data.url}" width="200" />`;
      } else {
        result.textContent = "Error al subir.";
      }
    });
  </script>
</Layout>
